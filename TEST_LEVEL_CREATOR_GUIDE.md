# 测试关卡创建器使用指南

## 🎯 功能说明

`TestLevelCreator` 是一个Unity编辑器工具，可以自动创建测试关卡，支持：
- ✅ 在场景中直接创建关卡对象
- ✅ 保存关卡为JSON文件
- ✅ 多种预设关卡模板
- ✅ 批量创建所有预设关卡

---

## 🚀 快速开始

### 1. 打开工具

```
Unity编辑器 -> Tools -> 测试关卡创建器
```

### 2. 选择创建选项

在工具窗口中：
- **在场景中创建**：勾选后会在当前场景中直接创建关卡对象
- **保存为JSON文件**：勾选后会保存关卡为JSON文件到 `Assets/Levels/` 文件夹

### 3. 设置关卡信息

- **关卡名称**：设置关卡名称（会添加后缀，如"简单"、"中等"等）
- **关卡ID**：设置关卡ID（用于文件命名）

### 4. 创建关卡

点击相应的按钮创建预设关卡：
- **创建简单关卡**：包含1个齿轮的基础关卡
- **创建中等关卡**：包含齿轮和杠杆的中等难度关卡
- **创建困难关卡**：包含多个齿轮、杠杆和弹簧的困难关卡
- **创建齿轮测试关卡**：专门测试齿轮功能的关卡
- **创建杠杆测试关卡**：专门测试杠杆功能的关卡
- **创建弹簧测试关卡**：专门测试弹簧功能的关卡
- **创建综合测试关卡**：包含所有组件类型的综合测试关卡

---

## 📋 预设关卡详情

### 简单关卡
- **起始位置**：(0, 2, 0)
- **终点位置**：(10, 0.5, 0)
- **组件**：
  - 1个齿轮 (5, 1, 0)

### 中等关卡
- **起始位置**：(0, 2, 0)
- **终点位置**：(15, 0.5, 0)
- **组件**：
  - 1个齿轮 (5, 1, 0)
  - 1个杠杆 (10, 0.5, 0)

### 困难关卡
- **起始位置**：(0, 2, 0)
- **终点位置**：(20, 0.5, 0)
- **组件**：
  - 2个齿轮 (5, 1, 0) 和 (10, 1.5, 0)
  - 1个杠杆 (12, 0.5, 0)
  - 1个弹簧 (15, 0.5, 0)

### 齿轮测试关卡
- **起始位置**：(0, 2, 0)
- **终点位置**：(12, 0.5, 0)
- **组件**：
  - 3个齿轮，均匀分布

### 杠杆测试关卡
- **起始位置**：(0, 2, 0)
- **终点位置**：(12, 0.5, 0)
- **组件**：
  - 2个杠杆，均匀分布

### 弹簧测试关卡
- **起始位置**：(0, 2, 0)
- **终点位置**：(12, 0.5, 0)
- **组件**：
  - 2个弹簧，均匀分布

### 综合测试关卡
- **起始位置**：(0, 2, 0)
- **终点位置**：(25, 0.5, 0)
- **组件**：
  - 2个齿轮
  - 2个杠杆
  - 2个弹簧
  - 所有组件按顺序排列

---

## 🎮 使用场景

### 场景1：在场景中创建测试关卡

**步骤**：
1. 打开 `Gameplay` 场景
2. 打开测试关卡创建器
3. 勾选"在场景中创建"
4. 取消勾选"保存为JSON文件"（如果只需要在场景中创建）
5. 点击"创建简单关卡"或其他按钮
6. 关卡对象会直接出现在场景中

**用途**：
- 快速测试游戏玩法
- 调试物理交互
- 调整关卡布局

---

### 场景2：保存关卡为JSON文件

**步骤**：
1. 打开测试关卡创建器
2. 勾选"保存为JSON文件"
3. 取消勾选"在场景中创建"（如果只需要保存文件）
4. 设置关卡ID
5. 点击创建按钮
6. JSON文件会保存到 `Assets/Levels/` 文件夹

**用途**：
- 创建关卡库
- 分享关卡
- 版本控制

---

### 场景3：批量创建所有预设关卡

**步骤**：
1. 打开测试关卡创建器
2. 设置起始关卡ID（例如：1）
3. 勾选需要的选项（在场景中创建/保存为JSON）
4. 点击"创建所有预设关卡"
5. 会创建7个预设关卡（ID: 1-7）

**结果**：
- 如果勾选"在场景中创建"：场景中会出现7个关卡对象
- 如果勾选"保存为JSON文件"：`Assets/Levels/` 文件夹中会有7个JSON文件

---

## 🧹 清理功能

### 清理场景中的测试关卡

**步骤**：
1. 打开测试关卡创建器
2. 点击"清理场景中的测试关卡"按钮
3. 确认删除
4. 所有名称以 `TestLevel_` 开头的对象会被删除

**注意**：
- 只会删除测试关卡对象
- 不会删除JSON文件
- 操作不可撤销，请谨慎使用

---

## 📁 文件结构

### 场景中的对象结构

```
TestLevel_简单_1
├── StartPoint (起始点)
├── Goal (终点)
├── Gear_0 (齿轮)
└── ...
```

### JSON文件结构

保存的JSON文件位于：
```
Assets/Levels/
├── TestLevel_简单_1.json
├── TestLevel_中等_2.json
├── TestLevel_困难_3.json
└── ...
```

---

## ⚙️ 配置说明

### 预制体路径

工具使用以下预制体路径（如果预制体不存在，会创建空对象）：
- 齿轮：`Assets/Prefabs/Generated/Gear.prefab`
- 杠杆：`Assets/Prefabs/Generated/Lever.prefab`
- 弹簧：`Assets/Prefabs/Generated/Spring.prefab`
- 小球：`Assets/Prefabs/Generated/Ball.prefab`

**注意**：如果预制体不存在，工具会创建空对象，你需要手动添加组件。

---

## 🔧 故障排除

### 问题1：场景中创建失败

**错误**：`场景文件不存在: Assets/Scenes/Gameplay.unity`

**解决**：
1. 确保 `Gameplay` 场景已创建
2. 或手动打开 `Gameplay` 场景后再创建关卡

---

### 问题2：预制体不存在

**警告**：`预制体不存在: Assets/Prefabs/Generated/Gear.prefab`

**解决**：
1. 运行预制体生成器：`Tools -> 预制体生成器 -> 一键生成所有预制体`
2. 或手动创建预制体

---

### 问题3：JSON文件保存失败

**错误**：文件夹不存在

**解决**：
- 工具会自动创建 `Assets/Levels/` 文件夹
- 如果仍然失败，手动创建文件夹

---

### 问题4：Goal对象没有触发器

**现象**：小球到达Goal时没有触发胜利

**解决**：
1. 选择Goal对象
2. 在Inspector中勾选Collider的"Is Trigger"
3. 确保Goal对象有正确的标签（如果使用标签系统）

---

## 💡 使用技巧

### 技巧1：快速测试不同难度

1. 批量创建所有预设关卡
2. 在场景中查看不同难度的布局
3. 选择最适合的难度进行测试

### 技巧2：创建关卡变体

1. 创建基础关卡
2. 在场景中手动调整组件位置
3. 使用关卡编辑器保存为新关卡

### 技巧3：组合使用

1. 先创建简单关卡测试基本功能
2. 再创建综合测试关卡测试所有组件
3. 最后创建困难关卡测试挑战性

---

## 📝 注意事项

1. **场景要求**：
   - 在场景中创建时，建议在 `Gameplay` 场景中操作
   - 如果不在 `Gameplay` 场景，工具会提示切换场景

2. **预制体要求**：
   - 确保所有预制体已生成
   - 如果预制体不存在，会创建空对象

3. **文件管理**：
   - JSON文件保存在 `Assets/Levels/` 文件夹
   - 建议使用版本控制管理关卡文件

4. **清理操作**：
   - 清理功能会永久删除对象
   - 操作前请确认

---

## 🎯 下一步

创建测试关卡后，你可以：

1. **测试游戏玩法**
   - 运行游戏
   - 测试小球与组件的交互
   - 调整物理参数

2. **优化关卡布局**
   - 调整组件位置
   - 添加更多组件
   - 调整难度

3. **保存自定义关卡**
   - 使用关卡编辑器保存
   - 或手动编辑JSON文件

---

**现在就开始创建你的第一个测试关卡吧！** 🎮

